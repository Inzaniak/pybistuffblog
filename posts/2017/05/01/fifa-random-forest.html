<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Python: Rank Fifa Players with Random Forest Classifier | Py, BI and Stuff</title>
<link href="../../../../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">
<link rel="canonical" href="https://inzaniak.github.io/pybistuffblog/posts/2017/05/01/fifa-random-forest.html">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><!-- Syntax highlight --><link rel="stylesheet" href="../../../../syntax/styles/zenburn.css">
<script src="../../../../syntax/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><!-- Syntax highlight --><!-- Google Analytics --><script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-90742675-2', 'auto');
ga('send', 'pageview');
</script><script async src="https://www.google-analytics.com/analytics.js"></script><!-- End Google Analytics --><meta name="author" content="Umberto Grando">
<link rel="prev" href="../../04/26/python-markovify.html" title="Python: Simple Markov Chains tutorial with Markovify" type="text/html">
<meta property="og:site_name" content="Py, BI and Stuff">
<meta property="og:title" content="Python: Rank Fifa Players with Random Forest Classifier">
<meta property="og:url" content="https://inzaniak.github.io/pybistuffblog/posts/2017/05/01/fifa-random-forest.html">
<meta property="og:description" content="Hello World!
      Today we are going to create a simple classification model by using a random forest classifier
    
    
    We are gonna need the dataset for this tutorial. You can get it from
   ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-05-01T07:54:34Z">
<meta property="article:tag" content="Python">
<link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A website about <strong>Python</strong>, <strong>Business Intelligence</strong> and<strong> Data Science</strong>. Powered by Python framework <strong>Nikola</strong>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../../../archive.html">Archives</a>
        <a class="sidebar-nav-item" href="../../../../categories/index.html">Tags</a>
        <a class="sidebar-nav-item" href="../../../../rss.xml">RSS feed</a>
        <a class="sidebar-nav-item" href="../../../../pages/contatti.html">Contacts</a>
        <a class="sidebar-nav-item" href="../../../../pages/informazioni.html">About me</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://inzaniak.github.io/pybistuffblog/" title="Py, BI and Stuff" rel="home">Py, BI and Stuff</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="post-title p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Python: Rank Fifa Players with Random Forest Classifier</a></h1>
    <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Umberto Grando</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="post-date published dt-published" datetime="2017-05-01T07:54:34+00:00" itemprop="datePublished" title="2017-05-01 07:54">2017-05-01 07:54</time></a></p>
                <p class="commentline">
        
    <a href="fifa-random-forest.html#disqus_thread" data-disqus-identifier="cache/posts/2017/05/01/fifa-random-forest.html">Comments</a>


        </p>
</div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>
  </p>
    <p>
      Hello World!<br>
      Today we are going to create a simple classification model by using a random forest classifier<br></p>
    <p>
    We are gonna need the dataset for this tutorial. You can get it from
    <a href="https://www.kaggle.com/artimous/complete-fifa-2017-player-dataset-global" class="url">here</a>.<br>
    If you don't know it, Kaggle is an awesome website where you can find all sort of open datasets for datascience
    and you can also compete with other users to earn prizes.<br>
    The project folder will be like this:<br><img class="alignnone size-full wp-image-404" src="../../../../2017/05/cmd-path.png" alt="Folder Tree" width="155" height="117"></p>
    <!-- <p> -->
      Let's start coding!
      <pre>
        <code>from sklearn.ensemble import RandomForestClassifier
import pandas as pd
import numpy as np\n
# Let's open the dataset
players = pd.read_csv("data/Fulldata.csv")</code>
      </pre>
      The first thing to do is to import pandas and numpy and to open the dataset
      as a pandas DataFrame. Don't worry if you have never used a dataframe before,
      we are going to take a look at how it works.
      <pre>
        <code># To check first 5 rows of the dataset
players.head()
# To check some numeric informations about a column
players.loc[:,'Rating'].describe()
# Get column names
list(players)
# Selection by label
players.loc[:,['Name','Rating']]
# Selection by index
players.iloc[:,[0,4]]</code>
      </pre>
      These are only a few of the many functions included in Pandas. I really suggest
      you to check <a href="http://pandas.pydata.org/pandas-docs/stable/10min.html" class="url">it</a> out.<br>
      Now we can go back to our program:
      <pre>
        <code># Add a column that tells us if it's Training Data or not
players['is_train'] = np.random.uniform(0, 1, len(players)) &lt;= .75\n
# Divide between training and testing data
train, test = players[players['is_train'] == True],players[players['is_train'] == False]\n
# We choose the columns with player stats
features = players.columns[17:53]
# Split into Training X(stats) and Y(rating) data
X = train[features]
Y = train.loc[:,'Rating']</code>
    </pre>
    In the first part of the code we add a column to tell us if it's train data or not
    by using a pandas function which creates a series of number with an uniform distribution.
    Then we divide our dataframe into train and test.<br>
    After this we need to choose which columns we are going to consider to train
    the model. We are going to use all the columns which contains player stats.<br>
    Then we split the training data into Features and Result.
    <pre>
      <code># Initialize the Classifier and train it
clf = RandomForestClassifier(n_jobs=4)
clf.fit(X, Y)\n
# Get the predictions
preds = clf.predict(test[features])</code>
    </pre>
    We can now initialize the classifier and get the predictions.
    <pre>
      <code># Create an output dataframe
out = test.loc[:,['Name','Rating']]
out['prediction'] = preds
out['diff']=out.loc[:,'Rating']-out.loc[:,'prediction']
# Let's print mean difference between predicted and actual
print('Mean difference: ',out['diff'].mean())
# And the number of exact matches
print('Exact Matches:',len(out[out['diff']==0]))</code>
    </pre>
    With this last step we are going to create an output dataframe from test.
    Then we add the column prediction and diff(difference between predicted value and rating)
    and finally we print the mean difference and the number of exact matches.<br>
    Your output should be similar to this:
    <pre>
      <code>Mean difference:  0.5449783648371669
Exact Matches: 821</code>
    </pre>
    We can also check the content of the output dataframe.
    <pre>
      <code>#Let's print the players with rating and prediction
print(out.loc[:,['Name','Rating','prediction','diff']])
# OUTPUT
#    Name                  Rating   prediction  diff
#0    Cristiano Ronaldo      94          88     6
#3          Luis Suárez      92          88     4
#4         Manuel Neuer      92          81    11
#8   Zlatan Ibrahimović      90          85     5
#10      Jérôme Boateng      89          85     4
      </code>
    </pre>
    We can improve our score by using another algorithm, but i think it's enough
    for today. You can download the code of this post <a href="https://github.com/Inzaniak/pybistuff/tree/master/Fifa" class="url"> here</a><br>
    Have fun experimenting with other datasets!
    <!-- </p> -->
  
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../categories/python.html" rel="tag">Python</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../../04/26/python-markovify.html" rel="prev" title="Python: Simple Markov Chains tutorial with Markovify">Previous post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="pybistuff",
            disqus_url="https://inzaniak.github.io/pybistuffblog/posts/2017/05/01/fifa-random-forest.html",
        disqus_title="Python: Rank Fifa Players with Random Forest Classifier",
        disqus_identifier="cache/posts/2017/05/01/fifa-random-forest.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="pybistuff";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!-- <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script> --><footer id="footer"><p>Contents © 2017         <a href="mailto:inzaniak@gmail.com">Umberto Grando</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
    
    
            <script src="../../../../assets/js/all-nocdn.js"></script><!-- Social buttons --><div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script><!-- End of social buttons --><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
