<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>Py, BI and Stuff (Posts about TSQL)</title><link>https://inzaniak.github.io/pybistuffblog/</link><description></description><atom:link href="https://inzaniak.github.io/pybistuffblog/categories/tsql.xml" type="application/rss+xml" rel="self"></atom:link><language>en</language><copyright>Contents © 2017 &lt;a href="mailto:inzaniak@gmail.com"&gt;Umberto Grando&lt;/a&gt; </copyright><lastBuildDate>Tue, 25 Apr 2017 15:40:55 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>MSSQL: Get all Columns from Tables/Views</title><link>https://inzaniak.github.io/pybistuffblog/posts/2017/02/02/mssql-get-all-columns-from-tablesviews.html</link><dc:creator>Umberto Grando</dc:creator><description>&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;When developing a database, it can be useful to be aware of column names on tables, in case one wants to check for aliasing errors or search for a specific column.&lt;/p&gt;
&lt;p&gt;To retrieve them, you just need to read from some system views.
&lt;/p&gt;&lt;ul&gt;
    &lt;li&gt;sys.columns: Contains the list of columns contained within the DB.&lt;/li&gt;
    &lt;li&gt;sys.tables: Contains the list of tables contained within the DB.&lt;/li&gt;
    &lt;li&gt;sys.schemas: Contains a list of the schemas contained within the DB.&lt;/li&gt;
    &lt;li&gt;sys.types: Contains the list of data types contained within the DB.&lt;/li&gt;
    &lt;li&gt;sys.views: Contains the list of views contained within the DB.&lt;/li&gt;
&lt;/ul&gt;
Launching one of these two scripts you will get the list of tables or views with their schemas and their columns with data types
&lt;p&gt;&lt;b&gt;Version with tables:&lt;/b&gt;
&lt;/p&gt;&lt;pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"&gt;&lt;span style="color:#66d9ef;"&gt;select&lt;/span&gt;   &lt;span style="color:#f8f8f2;"&gt;s.name&lt;/span&gt;   &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Schema&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,t.name&lt;/span&gt;   &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Table&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.name&lt;/span&gt;   &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Column&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,tp.name&lt;/span&gt;  &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Type&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.max_length&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Length&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;from&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.columns&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;join&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.tables&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;t&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;on&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.object_id&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;t.object_id&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;join&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.schemas&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;s&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;on&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;s.schema_id&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;t.schema_id&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;join&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.types&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;tp&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;on&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.system_type_id&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;tp.system_type_id&lt;/span&gt;
&lt;/pre&gt;
 
&lt;p&gt;&lt;b&gt;Version with Views:&lt;/b&gt;
&lt;/p&gt;&lt;pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"&gt;&lt;span style="color:#66d9ef;"&gt;select&lt;/span&gt;   &lt;span style="color:#f8f8f2;"&gt;s.name&lt;/span&gt;   &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Schema&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,v.name&lt;/span&gt;   &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;View&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.name&lt;/span&gt;   &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Column&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,tp.name&lt;/span&gt;  &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Type&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;,&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.max_length&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;as&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;[&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;Length&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;]&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;from&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.columns&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;join&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.views&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;v&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;on&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.object_id&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;v.object_id&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;join&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.schemas&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;s&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;on&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;s.schema_id&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;v.schema_id&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;join&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;sys.types&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;tp&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;on&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;c&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;.system_type_id&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;tp.system_type_id&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><category>Senza categoria</category><category>SQL</category><category>TSQL</category><guid>https://inzaniak.github.io/pybistuffblog/posts/2017/02/02/mssql-get-all-columns-from-tablesviews.html</guid><pubDate>Thu, 02 Feb 2017 10:22:15 GMT</pubDate></item></channel></rss>