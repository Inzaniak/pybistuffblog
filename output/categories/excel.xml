<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>Py, BI and Stuff (Posts about Excel)</title><link>https://inzaniak.github.io/pybistuffblog/</link><description></description><atom:link href="https://inzaniak.github.io/pybistuffblog/categories/excel.xml" type="application/rss+xml" rel="self"></atom:link><language>en</language><copyright>Contents Â© 2017 &lt;a href="mailto:inzaniak@gmail.com"&gt;Umberto Grando&lt;/a&gt; </copyright><lastBuildDate>Tue, 25 Apr 2017 15:40:55 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Excel: Format Cleaner Macro</title><link>https://inzaniak.github.io/pybistuffblog/posts/2017/02/02/excel-format-cleaner-macro.html</link><dc:creator>Umberto Grando</dc:creator><description>&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;A simple VBA script to clean all the formatting in cells.
&lt;img class=" size-full wp-image-60 aligncenter" src="https://inzaniak.github.io/pybistuffblog/2017/02/textclean.gif" alt="textclean" width="479" height="119"&gt;
&lt;/p&gt;&lt;pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"&gt;&lt;span style="color:#66d9ef;"&gt;Sub&lt;/span&gt; &lt;span style="color:#a6e22e;"&gt;CleanTxt&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;()&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Font.Bold&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;False&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Font.Italic&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;False&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Font.Underline&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlUnderlineStyleNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlDiagonalDown).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlDiagonalUp).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlEdgeLeft).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlEdgeTop).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlEdgeBottom).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlEdgeRight).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlInsideVertical).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#f8f8f2;"&gt;Selection.Borders(xlInsideHorizontal).LineStyle&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
    &lt;span style="color:#66d9ef;"&gt;With&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Selection.Interior&lt;/span&gt;
        &lt;span style="color:#f8f8f2;"&gt;.Pattern&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlNone&lt;/span&gt;
        &lt;span style="color:#f8f8f2;"&gt;.TintAndShade&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff;"&gt;0&lt;/span&gt;
        &lt;span style="color:#f8f8f2;"&gt;.PatternTintAndShade&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff;"&gt;0&lt;/span&gt;
    &lt;span style="color:#66d9ef;"&gt;End&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;With&lt;/span&gt;
    &lt;span style="color:#66d9ef;"&gt;With&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Selection.Font&lt;/span&gt;
        &lt;span style="color:#f8f8f2;"&gt;.ColorIndex&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;xlAutomatic&lt;/span&gt;
        &lt;span style="color:#f8f8f2;"&gt;.TintAndShade&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff;"&gt;0&lt;/span&gt;
    &lt;span style="color:#66d9ef;"&gt;End&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;With&lt;/span&gt;
&lt;span style="color:#66d9ef;"&gt;End&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Sub&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><category>Excel</category><category>Senza categoria</category><category>VBA</category><guid>https://inzaniak.github.io/pybistuffblog/posts/2017/02/02/excel-format-cleaner-macro.html</guid><pubDate>Thu, 02 Feb 2017 15:53:19 GMT</pubDate></item><item><title>Excel: How to filter tables based on cell content (Searchbox)</title><link>https://inzaniak.github.io/pybistuffblog/posts/2017/02/02/excel-how-to-filter-tables-based-on-cell-content-searchbox.html</link><dc:creator>Umberto Grando</dc:creator><description>&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;With this VB script you can create a simple searchbox:&lt;/p&gt;
&lt;p&gt;&lt;img class="alignnone size-full wp-image-41" src="https://inzaniak.github.io/pybistuffblog/2017/02/excsearch.gif" alt="excsearch" width="285" height="265"&gt;
&lt;/p&gt;&lt;pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"&gt;&lt;span style="color:#66d9ef;"&gt;Private&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Sub&lt;/span&gt; &lt;span style="color:#a6e22e;"&gt;Worksheet_Change&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;(&lt;/span&gt;&lt;span style="color:#66d9ef;"&gt;ByVal&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Target&lt;/span&gt; &lt;span style="color:#f92672;"&gt;As&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Range)&lt;/span&gt;
  &lt;span style="color:#75715e;"&gt;'Variable to clear filters on table&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;Dim&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;tableNum&lt;/span&gt; &lt;span style="color:#f92672;"&gt;As&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Integer&lt;/span&gt;
  &lt;span style="color:#75715e;"&gt;'Variable containing searchbox position&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;Dim&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;searchBoxPos&lt;/span&gt; &lt;span style="color:#f92672;"&gt;As&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;String&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;searchBoxPos&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74;"&gt;"B2"&lt;/span&gt;
  &lt;span style="color:#75715e;"&gt;'Var containing the first element of the column affected by the search&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;Dim&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;colToSearch&lt;/span&gt; &lt;span style="color:#f92672;"&gt;As&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;String&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;colToSearch&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74;"&gt;"B4"&lt;/span&gt;
&lt;p&gt;&lt;span style="color:#75715e;"&gt;'Check if searchbox cell is edited&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;If&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Not&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Application.Intersect(Target,&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Range(searchBoxPos))&lt;/span&gt; &lt;span style="color:#f92672;"&gt;Is&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Nothing&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Then&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;Range(Range(colToSearch),&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Range(colToSearch).End(xlDown)).AutoFilter&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Field:&lt;/span&gt;&lt;span style="color:#f92672;"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff;"&gt;1&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;,&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Criteria1:&lt;/span&gt;&lt;span style="color:#f92672;"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74;"&gt;"&lt;em&gt;"&lt;/em&gt;&lt;/span&gt; &lt;span style="color:#f92672;"&gt;&amp;amp;&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Range(searchBoxPos).Value&lt;/span&gt; &lt;span style="color:#f92672;"&gt;&amp;amp;&lt;/span&gt; &lt;span style="color:#e6db74;"&gt;""&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;,&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Operator&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;:&lt;/span&gt;&lt;span style="color:#f92672;"&gt;=&lt;/span&gt;&lt;span style="color:#f8f8f2;"&gt;xlAnd&lt;/span&gt;
  &lt;span style="color:#75715e;"&gt;'If searchbox is empty remove all filters&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;If&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;Range(searchBoxPos).Value&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74;"&gt;""&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Then&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;tableNum&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff;"&gt;1&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;For&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Each&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;element&lt;/span&gt; &lt;span style="color:#f92672;"&gt;In&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;ActiveSheet.ListObjects&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;ActiveSheet.ListObjects(tableNum).Range.AutoFilter&lt;/span&gt;
  &lt;span style="color:#f8f8f2;"&gt;tableNum&lt;/span&gt; &lt;span style="color:#f92672;"&gt;=&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;tableNum&lt;/span&gt; &lt;span style="color:#f92672;"&gt;+&lt;/span&gt; &lt;span style="color:#ae81ff;"&gt;1&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;Next&lt;/span&gt; &lt;span style="color:#f8f8f2;"&gt;element&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;End&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;If&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;End&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;If&lt;/span&gt;
  &lt;span style="color:#66d9ef;"&gt;End&lt;/span&gt; &lt;span style="color:#66d9ef;"&gt;Sub&lt;/span&gt;
&lt;/p&gt;&lt;/pre&gt;&lt;/div&gt;</description><category>Excel</category><category>Senza categoria</category><category>VBA</category><guid>https://inzaniak.github.io/pybistuffblog/posts/2017/02/02/excel-how-to-filter-tables-based-on-cell-content-searchbox.html</guid><pubDate>Thu, 02 Feb 2017 10:26:37 GMT</pubDate></item></channel></rss>