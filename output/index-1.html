<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="jack of all trades">
<meta name="viewport" content="width=device-width">
<title>Py, BI and Stuff (old posts, page 1) | Py, BI and Stuff</title>
<link href="assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://inzaniak.github.io/pybistuffblog/index-1.html">
<link rel="prev" href="index.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><!-- Syntax highlight --><link rel="stylesheet" href="syntax/styles/zenburn.css">
<script src="syntax/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><!-- Syntax highlight --><!-- Google Analytics --><script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-90742675-2', 'auto');
ga('send', 'pageview');
</script><script async src="https://www.google-analytics.com/analytics.js"></script><!-- End Google Analytics --><link href="https://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A website about <strong>Python</strong>, <strong>Business Intelligence</strong> and<strong> Data Science</strong>. Powered by Python framework <strong>Nikola</strong>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="archive.html">Archives</a>
        <a class="sidebar-nav-item" href="categories/index.html">Tags</a>
        <a class="sidebar-nav-item" href="rss.xml">RSS feed</a>
        <a class="sidebar-nav-item" href="pages/contatti.html">Contacts</a>
        <a class="sidebar-nav-item" href="pages/informazioni.html">About me</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://inzaniak.github.io/pybistuffblog/" title="Py, BI and Stuff" rel="home">Py, BI and Stuff</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/2017/03/16/python-get-method.html" class="u-url">Python: .get() method</a></h1>
        <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Umberto Grando</span></p>
            <p class="dateline"><a href="posts/2017/03/16/python-get-method.html" rel="bookmark"><time class="post-date published dt-published" datetime="2017-03-16T15:44:31+00:00" title="2017-03-16 15:44">2017-03-16 15:44</time></a></p>
                <p class="commentline">
        
    <a href="posts/2017/03/16/python-get-method.html#disqus_thread" data-disqus-identifier="cache/posts/2017/03/16/python-get-method.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p></p>
<p>One of the most annoying things that happens to me when i'm working with json extracted from social networks is the absence of some of the keys from the json.</p>
<p>If you try to read that the usual way:
</p>
<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#f92672;">import</span> <span style="color:#f8f8f2;">json</span>
<p><span style="color:#f8f8f2;">user_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">{</span>
    <span style="color:#ae81ff;">101</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"Mario"</span><span style="color:#f8f8f2;">,</span>
    <span style="color:#ae81ff;">102</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"John"</span><span style="color:#f8f8f2;">,</span>
    <span style="color:#ae81ff;">103</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"Lewis"</span><span style="color:#f8f8f2;">,</span>
    <span style="color:#ae81ff;">105</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"Andrew"</span>
<span style="color:#f8f8f2;">}</span></p>
<p><span style="color:#66d9ef;">for</span> <span style="color:#f8f8f2;">i</span> <span style="color:#f92672;">in</span> <span style="color:#f8f8f2;">range(</span><span style="color:#ae81ff;">101</span><span style="color:#f8f8f2;">,</span><span style="color:#ae81ff;">106</span><span style="color:#f8f8f2;">):</span>
    <span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(user_id[i])</span>
</p></pre>
You will have this error:
<p><img class="alignnone size-full wp-image-139" src="2017/03/img1.png" alt="img1" width="872" height="206">
Because you are referencing an element that doesn't exists.</p>
<p>You could solve this problem by using a Try - Except statement, but that will make the code longer and less readable.</p>
<p>The best way to fix this is by using .get():
</p>
<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#f92672;">import</span> <span style="color:#f8f8f2;">json</span>
<p><span style="color:#f8f8f2;">user_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">{</span>
    <span style="color:#ae81ff;">101</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"Mario"</span><span style="color:#f8f8f2;">,</span>
    <span style="color:#ae81ff;">102</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"John"</span><span style="color:#f8f8f2;">,</span>
    <span style="color:#ae81ff;">103</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"Lewis"</span><span style="color:#f8f8f2;">,</span>
    <span style="color:#ae81ff;">105</span><span style="color:#f8f8f2;">:</span> <span style="color:#e6db74;">"Andrew"</span>
<span style="color:#f8f8f2;">}</span></p>
<p><span style="color:#66d9ef;">for</span> <span style="color:#f8f8f2;">i</span> <span style="color:#f92672;">in</span> <span style="color:#f8f8f2;">range(</span><span style="color:#ae81ff;">101</span><span style="color:#f8f8f2;">,</span><span style="color:#ae81ff;">106</span><span style="color:#f8f8f2;">):</span>
    <span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(user_id</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">get(i,</span><span style="color:#e6db74;">"ND"</span><span style="color:#f8f8f2;">))</span>
</p></pre>
The method: ".get()" extract the element from the json as usual, but when the value doesn't exit it returns a value chosen by the user.
<p>This is really lifesaving when working with json.</p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/2017/02/07/python-clean-sql-views-for-documentation.html" class="u-url">Python: Clean SQL views for documentation</a></h1>
        <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Umberto Grando</span></p>
            <p class="dateline"><a href="posts/2017/02/07/python-clean-sql-views-for-documentation.html" rel="bookmark"><time class="post-date published dt-published" datetime="2017-02-07T17:47:19+00:00" title="2017-02-07 17:47">2017-02-07 17:47</time></a></p>
                <p class="commentline">
        
    <a href="posts/2017/02/07/python-clean-sql-views-for-documentation.html#disqus_thread" data-disqus-identifier="cache/posts/2017/02/07/python-clean-sql-views-for-documentation.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p></p>
<p>One of the most tedious tasks of working with databases is to write and maintain documentation, in particular writing reports from tables and views.</p>
<p>So why not try to make this task a bit less heavy by using Python?
</p>
<h6>Step0-The input and the output</h6>
The script requires that the views are created using create view.
Example:
<h6>Right click on view</h6>
<img class="alignnone  wp-image-107" src="2017/02/img1.png" alt="img1" width="477" height="298"><h6>Copy view</h6>
<img class="alignnone size-full wp-image-110" src="2017/02/img2.png" alt="img2" width="440" height="237"><h6>Output view after python script</h6>
<img class="alignnone size-full wp-image-121" src="2017/02/img3.png" alt="img3" width="424" height="224"><hr>
<h6>Step1 - Extract Columns Function</h6>

<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#66d9ef;">def</span> <span style="color:#a6e22e;">extract_columns</span><span style="color:#f8f8f2;">(in_txt):</span>
    <span style="color:#e6db74;">"""Simple function to extract columns between select and from"""</span>
    <span style="color:#75715e;"># Splitting by select i only choose text after select</span>
    <span style="color:#f8f8f2;">out_view</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">re</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">split(</span><span style="color:#e6db74;">r'(?i)\bselect\b'</span><span style="color:#f8f8f2;">,in_txt)[</span><span style="color:#ae81ff;">1</span><span style="color:#f8f8f2;">]</span>
    <span style="color:#75715e;"># Splitting by from i only choose text before from</span>
    <span style="color:#f8f8f2;">out_view</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">re</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">split(</span><span style="color:#e6db74;">r'(?i)\bfrom\b'</span><span style="color:#f8f8f2;">,out_view)[</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">]</span>
    <span style="color:#75715e;"># Cleaning extra spaces and tabs</span>
    <span style="color:#f8f8f2;">out_view</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">strip()</span>
    <span style="color:#66d9ef;">return</span> <span style="color:#f8f8f2;">out_view</span>
</pre>

<p>Let's start by defining a function with the purpose of extracting only the columns from the script of a view. Thus ignoring everything before the Select statement and everything after the From statement.</p>
<hr>
<h6>Step2 -Let's start from the variables</h6>

<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#f92672;">import</span> <span style="color:#f8f8f2;">re</span>

<span style="color:#75715e;"># We open the file containing the view</span>
<span style="color:#f8f8f2;">view</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">extract_columns(open(</span><span style="color:#e6db74;">'input.txt'</span><span style="color:#f8f8f2;">,</span><span style="color:#e6db74;">'r'</span><span style="color:#f8f8f2;">,encoding</span><span style="color:#f92672;">=</span><span style="color:#e6db74;">'utf-8'</span><span style="color:#f8f8f2;">)</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">read())</span>
<span style="color:#75715e;"># Now we insert text into the list and we create a new list</span>
<span style="color:#f8f8f2;">view_l</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">view</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">split(</span><span style="color:#e6db74;">'</span><span style="color:#ae81ff;">\n</span><span style="color:#e6db74;">'</span><span style="color:#f8f8f2;">)</span>
<span style="color:#f8f8f2;">out_l</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">[]</span>
</pre>

<p>Now we declare the variables we are going to use.
</p>
<ul>
<li>view: contains the input text</li>
    <li>view_l: is a list created by splitting text by line</li>
    <li>out_l: is the output list</li>
</ul>
<hr>
<h6>Step3-Main Code</h6>

<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#75715e;"># Now we loop through all the lines of the view</span>
<span style="color:#66d9ef;">for</span> <span style="color:#f8f8f2;">num,line</span> <span style="color:#f92672;">in</span> <span style="color:#f8f8f2;">enumerate(view_l):</span>
    <span style="color:#75715e;"># Clean extra spaces</span>
    <span style="color:#f8f8f2;">line</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">line</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">strip()</span>
    <span style="color:#75715e;"># Remove Comments</span>
    <span style="color:#f8f8f2;">line</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">line</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">split(</span><span style="color:#e6db74;">'--'</span><span style="color:#f8f8f2;">)[</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">]</span>
    <span style="color:#75715e;"># Remove Commas</span>
    <span style="color:#f8f8f2;">line</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">line</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">replace(</span><span style="color:#e6db74;">','</span><span style="color:#f8f8f2;">,</span><span style="color:#e6db74;">''<span style="color:#ffffff;">,</span>1</span><span style="color:#f8f8f2;">)</span>
    <span style="color:#75715e;"># Substitute Tabs with Spaces</span>
    <span style="color:#f8f8f2;">line</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">line</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">replace(</span><span style="color:#e6db74;">'</span><span style="color:#ae81ff;">\t</span><span style="color:#e6db74;">'</span><span style="color:#f8f8f2;">,</span><span style="color:#e6db74;">' '</span><span style="color:#f8f8f2;">)</span>
    <span style="color:#75715e;"># While two spaces are in line we substitute the with one space</span>
    <span style="color:#66d9ef;">while</span> <span style="color:#e6db74;">'  '</span> <span style="color:#f92672;">in</span> <span style="color:#f8f8f2;">line:</span>
        <span style="color:#f8f8f2;">line</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">line</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">replace(</span><span style="color:#e6db74;">'  '</span><span style="color:#f8f8f2;">,</span><span style="color:#e6db74;">' '</span><span style="color:#f8f8f2;">)</span>
    <span style="color:#75715e;"># Remove [ and ]</span>
    <span style="color:#f8f8f2;">line</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">line</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">replace</span> <span style="color:#f8f8f2;">(</span><span style="color:#e6db74;">'['</span><span style="color:#f8f8f2;">,</span><span style="color:#e6db74;">''</span><span style="color:#f8f8f2;">)</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">replace(</span><span style="color:#e6db74;">']'</span><span style="color:#f8f8f2;">,</span><span style="color:#e6db74;">''</span><span style="color:#f8f8f2;">)</span>
    <span style="color:#75715e;"># If line is not empty</span>
    <span style="color:#66d9ef;">if</span> <span style="color:#f8f8f2;">len(line)</span><span style="color:#f92672;">&gt;</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">:</span>
        <span style="color:#75715e;"># If line is not a comment</span>
        <span style="color:#66d9ef;">if</span> <span style="color:#f8f8f2;">line[</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">]</span><span style="color:#f92672;">!=</span><span style="color:#e6db74;">'-'</span><span style="color:#f8f8f2;">:</span>
            <span style="color:#75715e;"># We add the new line to out_l</span>
            <span style="color:#f8f8f2;">out_l</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">append(re</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">split(</span><span style="color:#e6db74;">r'(?i)\bas\b'</span><span style="color:#f8f8f2;">,line))</span>
</pre>

<p>Finally we come to the main code.
The first part is a For loop, using the list we created in step2.
For each line the script removes useless characters and comments and then adds the line to the new list.</p>
<hr>
<h6>Step4-Output Text</h6>

<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#75715e;"># Open output file</span>
<span style="color:#66d9ef;">with</span> <span style="color:#f8f8f2;">open(</span><span style="color:#e6db74;">'out.txt'</span><span style="color:#f8f8f2;">,</span><span style="color:#e6db74;">'w'</span><span style="color:#f8f8f2;">)</span> <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">out_txt:</span>
    <span style="color:#75715e;"># For line in output list</span>
    <span style="color:#66d9ef;">for</span> <span style="color:#f8f8f2;">line</span> <span style="color:#f92672;">in</span> <span style="color:#f8f8f2;">out_l:</span>
        <span style="color:#75715e;"># Try / Except to output all the values to the file separated by ','</span>
        <span style="color:#66d9ef;">print</span><span style="color:#f8f8f2;">(line)</span>
        <span style="color:#66d9ef;">if</span> <span style="color:#f8f8f2;">len(line)</span><span style="color:#f92672;">&gt;</span><span style="color:#ae81ff;">1</span><span style="color:#f8f8f2;">:</span>
            <span style="color:#f8f8f2;">out_txt</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">write(</span><span style="color:#e6db74;">'as'</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">join(line[</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">:</span><span style="color:#f92672;">-</span><span style="color:#ae81ff;">1</span><span style="color:#f8f8f2;">])</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">strip()</span><span style="color:#f92672;">+</span><span style="color:#e6db74;">'|'</span><span style="color:#f92672;">+</span><span style="color:#f8f8f2;">str(line[</span><span style="color:#f92672;">-</span><span style="color:#ae81ff;">1</span><span style="color:#f8f8f2;">])</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">strip()</span><span style="color:#f92672;">+</span><span style="color:#e6db74;">'</span><span style="color:#ae81ff;">\n</span><span style="color:#e6db74;">'</span><span style="color:#f8f8f2;">)</span>
        <span style="color:#66d9ef;">else</span><span style="color:#f8f8f2;">:</span>
            <span style="color:#f8f8f2;">out_txt</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">write(str(line[</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">])</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">strip()</span><span style="color:#f92672;">+</span><span style="color:#e6db74;">'|'</span><span style="color:#f92672;">+</span><span style="color:#f8f8f2;">str(line[</span><span style="color:#ae81ff;">0</span><span style="color:#f8f8f2;">])</span><span style="color:#f92672;">.</span><span style="color:#f8f8f2;">strip()</span><span style="color:#f92672;">+</span><span style="color:#e6db74;">'</span><span style="color:#ae81ff;">\n</span><span style="color:#e6db74;">'</span><span style="color:#f8f8f2;">)</span>
</pre>

<p>In the last part we write to an external file using a Try/Except to avoid IndexErrors.</p>
<p>This article is also available on <a href="https://powerbloggerbi.com">PowerBloggerBI</a></p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/2017/02/02/excel-format-cleaner-macro.html" class="u-url">Excel: Format Cleaner Macro</a></h1>
        <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Umberto Grando</span></p>
            <p class="dateline"><a href="posts/2017/02/02/excel-format-cleaner-macro.html" rel="bookmark"><time class="post-date published dt-published" datetime="2017-02-02T15:53:19+00:00" title="2017-02-02 15:53">2017-02-02 15:53</time></a></p>
                <p class="commentline">
        
    <a href="posts/2017/02/02/excel-format-cleaner-macro.html#disqus_thread" data-disqus-identifier="cache/posts/2017/02/02/excel-format-cleaner-macro.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p></p>
<p>A simple VBA script to clean all the formatting in cells.
<img class=" size-full wp-image-60 aligncenter" src="2017/02/textclean.gif" alt="textclean" width="479" height="119"></p>
<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#66d9ef;">Sub</span> <span style="color:#a6e22e;">CleanTxt</span><span style="color:#f8f8f2;">()</span>
    <span style="color:#f8f8f2;">Selection.Font.Bold</span> <span style="color:#f92672;">=</span> <span style="color:#66d9ef;">False</span>
    <span style="color:#f8f8f2;">Selection.Font.Italic</span> <span style="color:#f92672;">=</span> <span style="color:#66d9ef;">False</span>
    <span style="color:#f8f8f2;">Selection.Font.Underline</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlUnderlineStyleNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlDiagonalDown).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlDiagonalUp).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlEdgeLeft).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlEdgeTop).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlEdgeBottom).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlEdgeRight).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlInsideVertical).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#f8f8f2;">Selection.Borders(xlInsideHorizontal).LineStyle</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
    <span style="color:#66d9ef;">With</span> <span style="color:#f8f8f2;">Selection.Interior</span>
        <span style="color:#f8f8f2;">.Pattern</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlNone</span>
        <span style="color:#f8f8f2;">.TintAndShade</span> <span style="color:#f92672;">=</span> <span style="color:#ae81ff;">0</span>
        <span style="color:#f8f8f2;">.PatternTintAndShade</span> <span style="color:#f92672;">=</span> <span style="color:#ae81ff;">0</span>
    <span style="color:#66d9ef;">End</span> <span style="color:#66d9ef;">With</span>
    <span style="color:#66d9ef;">With</span> <span style="color:#f8f8f2;">Selection.Font</span>
        <span style="color:#f8f8f2;">.ColorIndex</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">xlAutomatic</span>
        <span style="color:#f8f8f2;">.TintAndShade</span> <span style="color:#f92672;">=</span> <span style="color:#ae81ff;">0</span>
    <span style="color:#66d9ef;">End</span> <span style="color:#66d9ef;">With</span>
<span style="color:#66d9ef;">End</span> <span style="color:#66d9ef;">Sub</span>
</pre>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/2017/02/02/excel-how-to-filter-tables-based-on-cell-content-searchbox.html" class="u-url">Excel: How to filter tables based on cell content (Searchbox)</a></h1>
        <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Umberto Grando</span></p>
            <p class="dateline"><a href="posts/2017/02/02/excel-how-to-filter-tables-based-on-cell-content-searchbox.html" rel="bookmark"><time class="post-date published dt-published" datetime="2017-02-02T10:26:37+00:00" title="2017-02-02 10:26">2017-02-02 10:26</time></a></p>
                <p class="commentline">
        
    <a href="posts/2017/02/02/excel-how-to-filter-tables-based-on-cell-content-searchbox.html#disqus_thread" data-disqus-identifier="cache/posts/2017/02/02/excel-how-to-filter-tables-based-on-cell-content-searchbox.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p></p>
<p>With this VB script you can create a simple searchbox:</p>
<p><img class="alignnone size-full wp-image-41" src="2017/02/excsearch.gif" alt="excsearch" width="285" height="265"></p>
<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><span style="color:#66d9ef;">Private</span> <span style="color:#66d9ef;">Sub</span> <span style="color:#a6e22e;">Worksheet_Change</span><span style="color:#f8f8f2;">(</span><span style="color:#66d9ef;">ByVal</span> <span style="color:#f8f8f2;">Target</span> <span style="color:#f92672;">As</span> <span style="color:#f8f8f2;">Range)</span>
  <span style="color:#75715e;">'Variable to clear filters on table</span>
  <span style="color:#66d9ef;">Dim</span> <span style="color:#f8f8f2;">tableNum</span> <span style="color:#f92672;">As</span> <span style="color:#66d9ef;">Integer</span>
  <span style="color:#75715e;">'Variable containing searchbox position</span>
  <span style="color:#66d9ef;">Dim</span> <span style="color:#f8f8f2;">searchBoxPos</span> <span style="color:#f92672;">As</span> <span style="color:#66d9ef;">String</span>
  <span style="color:#f8f8f2;">searchBoxPos</span> <span style="color:#f92672;">=</span> <span style="color:#e6db74;">"B2"</span>
  <span style="color:#75715e;">'Var containing the first element of the column affected by the search</span>
  <span style="color:#66d9ef;">Dim</span> <span style="color:#f8f8f2;">colToSearch</span> <span style="color:#f92672;">As</span> <span style="color:#66d9ef;">String</span>
  <span style="color:#f8f8f2;">colToSearch</span> <span style="color:#f92672;">=</span> <span style="color:#e6db74;">"B4"</span>
<p><span style="color:#75715e;">'Check if searchbox cell is edited</span>
  <span style="color:#66d9ef;">If</span> <span style="color:#66d9ef;">Not</span> <span style="color:#f8f8f2;">Application.Intersect(Target,</span> <span style="color:#f8f8f2;">Range(searchBoxPos))</span> <span style="color:#f92672;">Is</span> <span style="color:#66d9ef;">Nothing</span> <span style="color:#66d9ef;">Then</span>
  <span style="color:#f8f8f2;">Range(Range(colToSearch),</span> <span style="color:#f8f8f2;">Range(colToSearch).End(xlDown)).AutoFilter</span> <span style="color:#f8f8f2;">Field:</span><span style="color:#f92672;">=</span><span style="color:#ae81ff;">1</span><span style="color:#f8f8f2;">,</span> <span style="color:#f8f8f2;">Criteria1:</span><span style="color:#f92672;">=</span><span style="color:#e6db74;">"<em>"</em></span> <span style="color:#f92672;">&amp;</span> <span style="color:#f8f8f2;">Range(searchBoxPos).Value</span> <span style="color:#f92672;">&amp;</span> <span style="color:#e6db74;">""</span><span style="color:#f8f8f2;">,</span> <span style="color:#66d9ef;">Operator</span><span style="color:#f8f8f2;">:</span><span style="color:#f92672;">=</span><span style="color:#f8f8f2;">xlAnd</span>
  <span style="color:#75715e;">'If searchbox is empty remove all filters</span>
  <span style="color:#66d9ef;">If</span> <span style="color:#f8f8f2;">Range(searchBoxPos).Value</span> <span style="color:#f92672;">=</span> <span style="color:#e6db74;">""</span> <span style="color:#66d9ef;">Then</span>
  <span style="color:#f8f8f2;">tableNum</span> <span style="color:#f92672;">=</span> <span style="color:#ae81ff;">1</span>
  <span style="color:#66d9ef;">For</span> <span style="color:#66d9ef;">Each</span> <span style="color:#f8f8f2;">element</span> <span style="color:#f92672;">In</span> <span style="color:#f8f8f2;">ActiveSheet.ListObjects</span>
  <span style="color:#f8f8f2;">ActiveSheet.ListObjects(tableNum).Range.AutoFilter</span>
  <span style="color:#f8f8f2;">tableNum</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">tableNum</span> <span style="color:#f92672;">+</span> <span style="color:#ae81ff;">1</span>
  <span style="color:#66d9ef;">Next</span> <span style="color:#f8f8f2;">element</span>
  <span style="color:#66d9ef;">End</span> <span style="color:#66d9ef;">If</span>
  <span style="color:#66d9ef;">End</span> <span style="color:#66d9ef;">If</span>
  <span style="color:#66d9ef;">End</span> <span style="color:#66d9ef;">Sub</span>
</p></pre>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/2017/02/02/mssql-get-all-columns-from-tablesviews.html" class="u-url">MSSQL: Get all Columns from Tables/Views</a></h1>
        <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Umberto Grando</span></p>
            <p class="dateline"><a href="posts/2017/02/02/mssql-get-all-columns-from-tablesviews.html" rel="bookmark"><time class="post-date published dt-published" datetime="2017-02-02T10:22:15+00:00" title="2017-02-02 10:22">2017-02-02 10:22</time></a></p>
                <p class="commentline">
        
    <a href="posts/2017/02/02/mssql-get-all-columns-from-tablesviews.html#disqus_thread" data-disqus-identifier="cache/posts/2017/02/02/mssql-get-all-columns-from-tablesviews.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p></p>
<p>When developing a database, it can be useful to be aware of column names on tables, in case one wants to check for aliasing errors or search for a specific column.</p>
<p>To retrieve them, you just need to read from some system views.
</p>
<ul>
<li>sys.columns: Contains the list of columns contained within the DB.</li>
    <li>sys.tables: Contains the list of tables contained within the DB.</li>
    <li>sys.schemas: Contains a list of the schemas contained within the DB.</li>
    <li>sys.types: Contains the list of data types contained within the DB.</li>
    <li>sys.views: Contains the list of views contained within the DB.</li>
</ul>
Launching one of these two scripts you will get the list of tables or views with their schemas and their columns with data types
<p><b>Version with tables:</b>
</p>
<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#66d9ef;">select</span>   <span style="color:#f8f8f2;">s.name</span>   <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Schema</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,t.name</span>   <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Table</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,</span><span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.name</span>   <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Column</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,tp.name</span>  <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Type</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,</span><span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.max_length</span> <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Length</span><span style="color:#f8f8f2;">]</span>
<span style="color:#66d9ef;">from</span> <span style="color:#f8f8f2;">sys.columns</span> <span style="color:#66d9ef;">c</span>
<span style="color:#66d9ef;">join</span> <span style="color:#f8f8f2;">sys.tables</span> <span style="color:#f8f8f2;">t</span>
<span style="color:#66d9ef;">on</span> <span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.object_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">t.object_id</span>
<span style="color:#66d9ef;">join</span> <span style="color:#f8f8f2;">sys.schemas</span> <span style="color:#f8f8f2;">s</span>
<span style="color:#66d9ef;">on</span> <span style="color:#f8f8f2;">s.schema_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">t.schema_id</span>
<span style="color:#66d9ef;">join</span> <span style="color:#f8f8f2;">sys.types</span> <span style="color:#f8f8f2;">tp</span>
<span style="color:#66d9ef;">on</span> <span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.system_type_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">tp.system_type_id</span>
</pre>
 
<p><b>Version with Views:</b>
</p>
<pre style="background:#272822;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;margin:0;line-height:125%;"><span style="color:#66d9ef;">select</span>   <span style="color:#f8f8f2;">s.name</span>   <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Schema</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,v.name</span>   <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">View</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,</span><span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.name</span>   <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Column</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,tp.name</span>  <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Type</span><span style="color:#f8f8f2;">]</span>
  <span style="color:#f8f8f2;">,</span><span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.max_length</span> <span style="color:#66d9ef;">as</span> <span style="color:#f8f8f2;">[</span><span style="color:#66d9ef;">Length</span><span style="color:#f8f8f2;">]</span>
<span style="color:#66d9ef;">from</span> <span style="color:#f8f8f2;">sys.columns</span> <span style="color:#66d9ef;">c</span>
<span style="color:#66d9ef;">join</span> <span style="color:#f8f8f2;">sys.views</span> <span style="color:#f8f8f2;">v</span>
<span style="color:#66d9ef;">on</span> <span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.object_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">v.object_id</span>
<span style="color:#66d9ef;">join</span> <span style="color:#f8f8f2;">sys.schemas</span> <span style="color:#f8f8f2;">s</span>
<span style="color:#66d9ef;">on</span> <span style="color:#f8f8f2;">s.schema_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">v.schema_id</span>
<span style="color:#66d9ef;">join</span> <span style="color:#f8f8f2;">sys.types</span> <span style="color:#f8f8f2;">tp</span>
<span style="color:#66d9ef;">on</span> <span style="color:#66d9ef;">c</span><span style="color:#f8f8f2;">.system_type_id</span> <span style="color:#f92672;">=</span> <span style="color:#f8f8f2;">tp.system_type_id</span>
</pre>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/2017/02/02/dos-fix-wifi-by-command-prompt.html" class="u-url">DOS: Fix wifi by command prompt</a></h1>
        <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Umberto Grando</span></p>
            <p class="dateline"><a href="posts/2017/02/02/dos-fix-wifi-by-command-prompt.html" rel="bookmark"><time class="post-date published dt-published" datetime="2017-02-02T10:19:37+00:00" title="2017-02-02 10:19">2017-02-02 10:19</time></a></p>
                <p class="commentline">
        
    <a href="posts/2017/02/02/dos-fix-wifi-by-command-prompt.html#disqus_thread" data-disqus-identifier="cache/posts/2017/02/02/dos-fix-wifi-by-command-prompt.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p></p>
<p>More than once I found myself with the annoying problem of not being able to connect to a wifi network.</p>
<p>I'm sure it's happened to you.</p>
<p>Often just a simple reboot to fix the problem, but system reboots are slow and tedious. Through these commands you will be able to reset DNS, IP and Proxies.</p>
<p>Just run Command Prompt and paste the script by right-clicking.
</p>
<div style="background:#272822;border-width:.1em .1em .1em .8em;border:solid gray;overflow:auto;padding:.2em .6em;width:auto;">
<p style="line-height:125%;margin:0;"><span style="color:#f8f8f2;">ipconfig</span> <span style="color:#f8f8f2;">/flushdns</span></p>
<p style="line-height:125%;margin:0;"><span style="color:#f8f8f2;">ipconfig</span> <span style="color:#f8f8f2;">/release</span></p>
<p style="line-height:125%;margin:0;"><span style="color:#f8f8f2;">ipconfig</span> <span style="color:#f8f8f2;">/renew</span></p>
<p style="line-height:125%;margin:0;"><span style="color:#f8f8f2;">set</span> <span style="color:#f8f8f2;">http_proxy</span><span style="color:#f92672;">=</span></p>
<p style="line-height:125%;margin:0;"><span style="color:#f8f8f2;">set</span> <span style="color:#f8f8f2;">https_proxy</span><span style="color:#f92672;">=</span></p>
<p></p>
</div>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index.html" rel="prev">Newer posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="pybistuff";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!-- <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script> --><footer id="footer"><p>Contents © 2017         <a href="mailto:inzaniak@gmail.com">Umberto Grando</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
    
    
            <script src="assets/js/all-nocdn.js"></script><!-- Social buttons --><div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script><!-- End of social buttons --><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
